flight_scatter <- ggplot(flight_totals,
aes(x = total_emissions, y = ppt, label = airline)) +
geom_point() +
geom_text(hjust = 0, nudge_x = 0.05) +
te_style() +
labs(title = "Price per tonne",
x = "New x label")
flight_scatter
knitr::opts_chunk$set(echo = TRUE)
source("styles.R")
pacman::p_load(tidyverse, ggplot2, readxl, janitor)
sheets<- "202310_data_viz_task_data.xlsx"
names <- excel_sheets(sheets)
data <- lapply(names, read_excel, path = sheets)
c02_costs <- read_csv("costs.csv")
flights <- as.data.frame(data[1]) %>%
clean_names() %>%
rename(airline = x1,
`EU/Swiss ETS` = priced_under_eu_and_ch_ets,
`UK ETS` = priced_under_uk_ets  ,
`Allowances, EU/CH` = free_allowances_under_ets_eu_ch,
`No ETS` = departing_emissions_not_by_any_ets) %>%
pivot_longer(!airline, names_to = "price", values_to = "value")
flights$price <- factor(flights$price, levels = c("EU/Swiss ETS", "UK ETS", "Allowances, EU/CH", "No ETS"))
flight_bar <- ggplot(flights, aes(x = reorder(airline, value), y = value, group = airline,  fill = price)) +
geom_col(position = "fill") +
coord_flip() +
te_style() +
theme(panel.grid.major.y = element_blank()) +
labs(title = "How much do airlines pay for pollution?")
flight_totals <- flights %>%
group_by(airline) %>%
summarise(total_emissions = sum(value)) %>%
left_join(c02_costs)
flight_scatter <- ggplot(flight_totals,
aes(x = total_emissions, y = ppt, label = airline)) +
geom_point() +
geom_text(hjust = 0, nudge_x = 0.05) +
te_style() +
labs(title = "Price per tonne",
x = "New x label")
flight_scatter
flight_bar <- ggplot(flights, aes(x = reorder(airline, value), y = value, group = airline,  fill = price)) +
geom_col(position = "stack") +
coord_flip() +
te_style() +
theme(panel.grid.major.y = element_blank()) +
labs(title = "How much do airlines pay for pollution?")
flight_bar
install.packages(" extrafonts ")
knitr::opts_chunk$set(echo = TRUE)
source("styles.R")
pacman::p_load(tidyverse, ggplot2, readxl, janitor, extrafonts)
sheets<- "202310_data_viz_task_data.xlsx"
names <- excel_sheets(sheets)
data <- lapply(names, read_excel, path = sheets)
c02_costs <- read_csv("costs.csv")
pacman::p_load(tidyverse, ggplot2, readxl, janitor, extrafont)
flights <- as.data.frame(data[1]) %>%
clean_names() %>%
rename(airline = x1,
`EU/Swiss ETS` = priced_under_eu_and_ch_ets,
`UK ETS` = priced_under_uk_ets  ,
`Allowances, EU/CH` = free_allowances_under_ets_eu_ch,
`No ETS` = departing_emissions_not_by_any_ets) %>%
pivot_longer(!airline, names_to = "price", values_to = "value")
flights$price <- factor(flights$price, levels = c("EU/Swiss ETS", "UK ETS", "Allowances, EU/CH", "No ETS"))
flight_bar <- ggplot(flights, aes(x = reorder(airline, value), y = value, group = airline,  fill = price)) +
geom_col(position = "stack") +
coord_flip() +
te_style() +
theme(panel.grid.major.y = element_blank()) +
labs(title = "How much do airlines pay for pollution?")
flight_bar
flight_totals <- flights %>%
group_by(airline) %>%
summarise(total_emissions = sum(value)) %>%
left_join(c02_costs)
flight_scatter <- ggplot(flight_totals,
aes(x = total_emissions, y = ppt, label = airline)) +
geom_point() +
geom_text(hjust = 0, nudge_x = 0.05) +
te_style() +
labs(title = "Price per tonne",
x = "New x label")
flight_scatter
knitr::opts_chunk$set(echo = TRUE)
source("styles.R")
pacman::p_load(tidyverse, ggplot2, readxl, janitor, extrafont)
sheets<- "202310_data_viz_task_data.xlsx"
names <- excel_sheets(sheets)
data <- lapply(names, read_excel, path = sheets)
c02_costs <- read_csv("costs.csv")
target_supply <- read_csv("supply_targets.csv")
targets_and_oversupply <- ggplot(target_supply,
aes(x = target,
y = oversupply)) +
geom_line()
targets_and_oversupply
targets_and_oversupply <- ggplot(target_supply,
aes(x = target,
y = oversupply)) +
geom_line()
targets_and_oversupply
target_supply <- read_csv("supply_targets.csv")
targets_and_oversupply <- ggplot(target_supply,
aes(x = target,
y = oversupply)) +
geom_line()
targets_and_oversupply
targets_and_oversupply <- ggplot(target_supply,
aes(x = target,
y = oversupply)) +
geom_line() +
geom_point()
targets_and_oversupply
targets_and_oversupply <- ggplot(target_supply,
aes(x = target,
y = oversupply)) +
geom_line() +
geom_point() +
te_style()
targets_and_oversupply <- ggplot(target_supply,
aes(x = target,
y = oversupply)) +
geom_line() +
geom_point() +
te_style()
targets_and_oversupply
targets_and_oversupply <- ggplot(target_supply,
aes(x = target,
y = oversupply)) +
geom_line(style = " dotted") +
geom_point() +
te_style()
targets_and_oversupply <- ggplot(target_supply,
aes(x = target,
y = oversupply)) +
geom_line(type = " dotted") +
geom_point() +
te_style()
targets_and_oversupply <- ggplot(target_supply,
aes(x = target,
y = oversupply)) +
geom_line(type = " dotted") +
geom_point() +
te_style()
targets_and_oversupply
targets_and_oversupply <- ggplot(target_supply,
aes(x = target,
y = oversupply)) +
geom_line(type = "dotted") +
geom_point() +
te_style()
targets_and_oversupply
targets_and_oversupply <- ggplot(target_supply,
aes(x = target,
y = oversupply)) +
geom_line(linetype = "dotted") +
geom_point() +
te_style()
targets_and_oversupply
fuel <- as.data.frame(data[2])
glimpse(fuel)
fuel <- as.data.frame(data[2]) %>%
mutate(fuel_type = "Petrol") %>%
cbind(as.data.frame(data[2]) %>%
mutate(fuel_type = "Diesel"))
glimpse(fuel)
ggplot(fuel,
aes(x = date,
y = value,
colour = country) +
geom_line() +
facet_wrap(~fuel_type)
y = ))
facet_wrap(~fuel_type)
colour = country) +
ggplot(fuel,
aes(x = date,
y = value,
colour = country)) +
geom_line() +
facet_wrap(~fuel_type)
fuel <- as.data.frame(data[2]) %>%
mutate(fuel_type = "Petrol") %>%
cbind(as.data.frame(data[2]) %>%
mutate(fuel_type = "Diesel")) %>%
pivot_longer(!c(date, fuel_type), names_to = "country", values_to = "value")
glimpse(fuel)
fuel <- as.data.frame(data[2]) %>%
mutate(fuel_type = "Petrol") %>%
cbind(as.data.frame(data[2]) %>%
mutate(fuel_type = "Diesel")) %>%
clean_names() %>%
pivot_longer(!c(date, fuel_type), names_to = "country", values_to = "value")
fuel <- as.data.frame(data[2]) %>%
mutate(fuel_type = "Petrol") %>%
cbind(as.data.frame(data[2]) %>%
mutate(fuel_type = "Diesel"))
View(fuel)
fuel <- as.data.frame(data[2]) %>%
mutate(fuel_type = "Petrol") %>%
cbind(as.data.frame(data[2]) %>%
mutate(fuel_type = "Diesel")) %>%
clean_names()
fuel <- as.data.frame(data[2]) %>%
mutate(fuel_type = "Petrol") %>%
rbind(as.data.frame(data[2]) %>%
mutate(fuel_type = "Diesel")) %>%
clean_names()
fuel <- as.data.frame(data[2]) %>%
mutate(fuel_type = "Petrol") %>%
rbind(as.data.frame(data[2]) %>%
mutate(fuel_type = "Diesel")) %>%
clean_names() %>%
pivot_longer(!c(date, fuel_type), names_to = "country", values_to = "value")
ggplot(fuel,
aes(x = date,
y = value,
colour = country)) +
geom_line() +
facet_wrap(~ fuel_type)
fuel <- as.data.frame(data[2]) %>%
mutate(fuel_type = "Petrol") %>%
rbind(as.data.frame(data[2]) %>%
mutate(fuel_type = "Diesel")) %>%
clean_names() %>%
pivot_longer(!c(date, fuel_type), names_to = "country", values_to = "value") %>%
filter(date %in% c(min(date), max(date)))
fuel
unique(fuel$date)
glimpse(fuel)
fuel <- as.data.frame(data[2]) %>%
mutate(fuel_type = "Petrol") %>%
rbind(as.data.frame(data[2]) %>%
mutate(fuel_type = "Diesel")) %>%
clean_names() %>%
pivot_longer(!c(date, fuel_type), names_to = "country", values_to = "value") %>%
filter(date %in% c(min(date), max(date))) %>%
pivot_wider(names_from = date, values_from = value)
glimpse(fuel)
fuel <- as.data.frame(data[2]) %>%
mutate(fuel_type = "Petrol") %>%
rbind(as.data.frame(data[2]) %>%
mutate(fuel_type = "Diesel")) %>%
clean_names() %>%
pivot_longer(!c(date, fuel_type), names_to = "country", values_to = "value") %>%
filter(date %in% c(min(date), max(date))) %>%
pivot_wider(names_from = date, values_from = value)
mutate(change = (`2022-02-22` - `2019-01-01`)/`2019-01-01`)
fuel <- as.data.frame(data[2]) %>%
mutate(fuel_type = "Petrol") %>%
rbind(as.data.frame(data[2]) %>%
mutate(fuel_type = "Diesel")) %>%
clean_names() %>%
pivot_longer(!c(date, fuel_type), names_to = "country", values_to = "value") %>%
filter(date %in% c(min(date), max(date))) %>%
pivot_wider(names_from = date, values_from = value) %>%
mutate(change = (`2022-02-22` - `2019-01-01`)/`2019-01-01`)
glimpse(fuel)
fuel <- as.data.frame(data[2]) %>%
mutate(fuel_type = "Petrol") %>%
rbind(as.data.frame(data[2]) %>%
mutate(fuel_type = "Diesel")) %>%
clean_names() %>%
pivot_longer(!c(date, fuel_type), names_to = "country", values_to = "value") %>%
filter(date %in% c(min(date), max(date))) %>%
pivot_wider(names_from = date, values_from = value) %>%
mutate(change = (`2022-02-22` - `2019-01-01`)/`2019-01-01`,
`Jan '19` = 0,
`Feb '20` = change)
fuel <- as.data.frame(data[2]) %>%
mutate(fuel_type = "Petrol") %>%
rbind(as.data.frame(data[2]) %>%
mutate(fuel_type = "Diesel")) %>%
clean_names() %>%
pivot_longer(!c(date, fuel_type), names_to = "country", values_to = "value") %>%
filter(date %in% c(min(date), max(date))) %>%
pivot_wider(names_from = date, values_from = value) %>%
mutate(change = (`2022-02-22` - `2019-01-01`)/`2019-01-01`,
`Jan '19` = 0,
`Feb '20` = change) %>%
pivot_longer(c(`Jan '19`, `Feb '20`), names_to = "change_date", values_to = "value")
ggplot(fuel,
aes(x = change_date,
y = value,
colour = country)) +
geom_line() +
facet_wrap(~ fuel_type)
ggplot(fuel,
aes(x = change_date,
y = value,
group = country,
colour = country)) +
geom_line() +
facet_wrap(~ fuel_type)
ggplot(fuel,
aes(x = reverse(change_date),
y = value,
group = country,
colour = country)) +
geom_line() +
facet_wrap(~ fuel_type)
fuel <- as.data.frame(data[2]) %>%
mutate(fuel_type = "Petrol") %>%
rbind(as.data.frame(data[2]) %>%
mutate(fuel_type = "Diesel")) %>%
clean_names() %>%
pivot_longer(!c(date, fuel_type), names_to = "country", values_to = "value") %>%
filter(date %in% c(min(date), max(date))) %>%
pivot_wider(names_from = date, values_from = value) %>%
mutate(change = (`2022-02-22` - `2019-01-01`)/`2019-01-01`,
`Jan '19` = 0,
`Feb '20` = change) %>%
pivot_longer(c(`Jan '19`, `Feb '20`), names_to = "change_date", values_to = "value")
fuel$change_date <- factor(fuel$change_date, levels = c("Jan '19", "Feb '20"))
ggplot(fuel,
aes(x = change,
y = value,
group = country,
colour = country)) +
geom_line() +
facet_wrap(~ fuel_type)
fuel <- as.data.frame(data[2]) %>%
mutate(fuel_type = "Petrol") %>%
rbind(as.data.frame(data[2]) %>%
mutate(fuel_type = "Diesel")) %>%
clean_names() %>%
pivot_longer(!c(date, fuel_type), names_to = "country", values_to = "value") %>%
filter(date %in% c(min(date), max(date))) %>%
pivot_wider(names_from = date, values_from = value) %>%
mutate(change = (`2022-02-22` - `2019-01-01`)/`2019-01-01`,
`Jan '19` = 0,
`Feb '20` = change) %>%
pivot_longer(c(`Jan '19`, `Feb '20`), names_to = "change_date", values_to = "value")
# fuel$change_date <- factor(fuel$change_date, levels = c("Jan '19", "Feb '20"))
ggplot(fuel,
aes(x = change,
y = value,
group = country,
colour = country)) +
geom_line() +
facet_wrap(~ fuel_type)
fuel <- as.data.frame(data[2]) %>%
mutate(fuel_type = "Petrol") %>%
rbind(as.data.frame(data[2]) %>%
mutate(fuel_type = "Diesel")) %>%
clean_names() %>%
pivot_longer(!c(date, fuel_type), names_to = "country", values_to = "value") %>%
filter(date %in% c(min(date), max(date))) %>%
pivot_wider(names_from = date, values_from = value) %>%
mutate(change = (`2022-02-22` - `2019-01-01`)/`2019-01-01`,
`Jan '19` = 0,
`Feb '20` = change) %>%
pivot_longer(c(`Jan '19`, `Feb '20`), names_to = "change_date", values_to = "value")
# fuel$change_date <- factor(fuel$change_date, levels = c("Jan '19", "Feb '20"))
ggplot(fuel,
aes(x = change,
y = value,
group = country,
colour = country)) +
geom_line() +
facet_wrap(~ fuel_type)
fuel <- as.data.frame(data[2]) %>%
mutate(fuel_type = "Petrol") %>%
rbind(as.data.frame(data[2]) %>%
mutate(fuel_type = "Diesel")) %>%
clean_names() %>%
pivot_longer(!c(date, fuel_type), names_to = "country", values_to = "value") %>%
filter(date %in% c(min(date), max(date))) %>%
pivot_wider(names_from = date, values_from = value) %>%
mutate(change = (`2022-02-22` - `2019-01-01`)/`2019-01-01`,
`Jan '19` = 0,
`Feb '20` = change) %>%
pivot_longer(c(`Jan '19`, `Feb '20`), names_to = "change_date", values_to = "value")
# fuel$change_date <- factor(fuel$change_date, levels = c("Jan '19", "Feb '20"))
ggplot(fuel,
aes(x = change_date,
y = value,
group = country,
colour = country)) +
geom_line() +
facet_wrap(~ fuel_type)
fuel <- as.data.frame(data[2]) %>%
mutate(fuel_type = "Petrol") %>%
rbind(as.data.frame(data[2]) %>%
mutate(fuel_type = "Diesel")) %>%
clean_names() %>%
pivot_longer(!c(date, fuel_type), names_to = "country", values_to = "value") %>%
filter(date %in% c(min(date), max(date))) %>%
pivot_wider(names_from = date, values_from = value) %>%
mutate(change = (`2022-02-22` - `2019-01-01`)/`2019-01-01`,
`Jan '19` = 0,
`Feb '20` = change) %>%
pivot_longer(c(`Jan '19`, `Feb '20`), names_to = "change_date", values_to = "value")
fuel$change_date <- factor(fuel$change_date, levels = c("Jan '19", "Feb '20"))
ggplot(fuel,
aes(x = change_date,
y = value,
group = country,
colour = country)) +
geom_line() +
facet_wrap(~ fuel_type)
ggplot(fuel,
aes(x = change_date,
y = value,
group = country,
colour = country)) +
geom_line() +
facet_wrap(~ fuel_type, ncol = 1)
fuel %>%
arrange(desc(change))
fuel %>% filter(fuel_type == "Petrol") %>% arrange(desc(change))
country_codes <- read_csv("country_codes")
country_codes <- read_csv("country_codes.csv")
glimpse(country_codes)
fuel <- as.data.frame(data[2]) %>%
mutate(fuel_type = "Petrol") %>%
rbind(as.data.frame(data[2]) %>%
mutate(fuel_type = "Diesel")) %>%
clean_names() %>%
pivot_longer(!c(date, fuel_type), names_to = "country", values_to = "value") %>%
filter(date %in% c(min(date), max(date))) %>%
pivot_wider(names_from = date, values_from = value) %>%
mutate(change = (`2022-02-22` - `2019-01-01`)/`2019-01-01`,
`Jan '19` = 0,
`Feb '20` = change) %>%
pivot_longer(c(`Jan '19`, `Feb '20`), names_to = "change_date", values_to = "value") %>%
left_join(country_codes %>% rename(country = `alpha-2`))
fuel$change_date <- factor(fuel$change_date, levels = c("Jan '19", "Feb '20"))
ggplot(fuel,
aes(x = change_date,
y = value,
group = country,
colour = country)) +
geom_line() +
facet_wrap(~ fuel_type, ncol = 1)
guel
fuel
glimpse(country_codes)
fuel <- as.data.frame(data[2]) %>%
mutate(fuel_type = "Petrol") %>%
rbind(as.data.frame(data[2]) %>%
mutate(fuel_type = "Diesel")) %>%
clean_names() %>%
pivot_longer(!c(date, fuel_type), names_to = "country", values_to = "value") %>%
filter(date %in% c(min(date), max(date))) %>%
pivot_wider(names_from = date, values_from = value) %>%
mutate(change = (`2022-02-22` - `2019-01-01`)/`2019-01-01`,
`Jan '19` = 0,
`Feb '20` = change,
country = toupper(country)) %>%
pivot_longer(c(`Jan '19`, `Feb '20`), names_to = "change_date", values_to = "value") %>%
left_join(country_codes %>%
select(`alpha-2`, name) %>%
rename(country = `alpha-2`))
glimpse(fuel)
unique(fuel$country)
fuel <- as.data.frame(data[2]) %>%
mutate(fuel_type = "Petrol") %>%
rbind(as.data.frame(data[2]) %>%
mutate(fuel_type = "Diesel")) %>%
clean_names() %>%
rowwise() %>%
mutate(xmean = mean()) %>%
ungroup() %>%
pivot_longer(!c(date, fuel_type), names_to = "country", values_to = "value") %>%
filter(date %in% c(min(date), max(date))) %>%
pivot_wider(names_from = date, values_from = value) %>%
mutate(change = (`2022-02-22` - `2019-01-01`)/`2019-01-01`,
`Jan '19` = 0,
`Feb '20` = change,
country = toupper(country)) %>%
pivot_longer(c(`Jan '19`, `Feb '20`), names_to = "change_date", values_to = "value") %>%
left_join(country_codes %>%
select(`alpha-2`, name) %>%
rename(country = `alpha-2`))
unique(fuel$country)
countries <- unique(as.data.frame(data[2]) pivot_longer(!c(date, fuel_type), names_to = "country", values_to = "value"))$country)
countries <- unique(as.data.frame(data[2]) %>% pivot_longer(!c(date, fuel_type), names_to = "country", values_to = "value"))$country)
countries <- unique(as.data.frame(data[2]) %>% pivot_longer(!c(date, fuel_type), names_to = "country", values_to = "value"))$country
countries <- unique(as.data.frame(data[2]) %>% pivot_longer(!Date, names_to = "country", values_to = "value"))$country
countries
countries <- unique(as.data.frame(data[2]) %>% pivot_longer(!Date, names_to = "country", values_to = "value")$country)
countries <- unique(as.data.frame(data[2]) %>% pivot_longer(!Date, names_to = "country", values_to = "value"))$country
countries
countries <- as.data.frame(data[2]) %>% pivot_longer(!Date, names_to = "country", values_to = "value"))
countries <- as.data.frame(data[2]) %>% pivot_longer(!Date, names_to = "country", values_to = "value")
countries
countries <- unique(as.data.frame(data[2]) %>% pivot_longer(!Date, names_to = "country", values_to = "value"))$country
countries
fuel <- as.data.frame(data[2]) %>%
mutate(fuel_type = "Petrol") %>%
rbind(as.data.frame(data[2]) %>%
mutate(fuel_type = "Diesel")) %>%
clean_names() %>%
# rowwise() %>%
# mutate(xmean = mean()) %>%
# ungroup() %>%
pivot_longer(!c(date, fuel_type), names_to = "country", values_to = "value") %>%
filter(date %in% c(min(date), max(date))) %>%
pivot_wider(names_from = date, values_from = value) %>%
mutate(change = (`2022-02-22` - `2019-01-01`)/`2019-01-01`,
`Jan '19` = 0,
`Feb '20` = change,
country = toupper(country)) %>%
pivot_longer(c(`Jan '19`, `Feb '20`), names_to = "change_date", values_to = "value") %>%
left_join(country_codes %>%
select(`alpha-2`, name) %>%
rename(country = `alpha-2`))
glimpse(fuel)
